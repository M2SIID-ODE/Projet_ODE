WITH
MEMBER Measures.[DIFF VENTE] AS '([Measures].[UNITES VENDUES]-([Measures].[UNITES VENDUES], [DIM TEMPS].[Month Year].CURRENTMEMBER.PrevMember))'

/*
FORMATAGE DU MEMBRE EVOLUTION DES VOLUMES DE VENTE
TRANSFORMATION DES CELLULES N/A EN NULL POUR ENSUITE ELIMINER TOUS LES TUPLES NULL  A TRAVERS LA FONCTION "NON EMPTY"
*/
MEMBER Measures.[Evolution Volume Vente] AS 
IIF (ISEMPTY([Measures].[DIFF VENTE]) or ISEMPTY([Measures].[UNITES VENDUES]) ,Null ,
	IIF ([Measures].[UNITES VENDUES]<=0,0,
			IIF ([Measures].[DIFF VENTE]<>0,[Measures].[DIFF VENTE]/[Measures].[UNITES VENDUES],"null"))),FORMAT_STRING="##.#%"

--===================================================
 


SELECT NON EMPTY { [Measures].[UNITES VENDUES],Measures.[Evolution Volume Vente] } ON COLUMNS, NON EMPTY { ([DIM PRODUITS].[LIBEL RAYON].[LIBEL RAYON].ALLMEMBERS * [DIM TEMPS].[Month Year].[Month Year].ALLMEMBERS ) } DIMENSION PROPERTIES MEMBER_CAPTION, MEMBER_UNIQUE_NAME ON ROWS FROM ( SELECT ( STRTOSET(@DIMTEMPSMOISNOM, CONSTRAINED) ) ON COLUMNS FROM ( SELECT ( STRTOSET(@DIMCATEGORIESLIBELRAYON, CONSTRAINED) ) ON COLUMNS FROM [CubeODE])) CELL PROPERTIES VALUE, BACK_COLOR, FORE_COLOR, FORMATTED_VALUE, FORMAT_STRING, FONT_NAME, FONT_SIZE, FONT_FLAGS
